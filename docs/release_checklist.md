# リリースチェックリスト

本ドキュメントは Duel Performance Logger v0.4 系のリリース作業における確認事項をまとめています。

## バージョン管理
- アプリの表示バージョンは **必ずデータベースの `app_meta.app_version`** に保存された値を参照します。UI、ログ、CLI (`python -m app.main --version`) すべてがこの値に同期されます。
- 新しいリリースを行う際は、マイグレーションまたはシードスクリプトで `app_meta` の値を更新してください。コード内の定数変更では UI 表示は更新されません。
- `app/function/core/version.py` の `__version__` はパッケージングやテスト向けの開発メタデータです。表示用途には使用しません。

## データベース確認
- マイグレーション前後に `PRAGMA integrity_check` が自動実行されます。失敗時は ZIP バックアップが作成されるため、内容を確認して復旧手順に従ってください。
- 旧バージョンの DB を利用する場合はマイグレーション後に `app_meta` の初期値が期待通り (`0.4.2` など) に設定されているか確認します。

## テストと CI
- `pytest` を実行し、メタデータ操作や録画機能に関するテストがすべて成功することを確認します。
- GitHub Actions (`.github/workflows/ci.yml`) では lint・pytest の両方が成功する必要があります。

## 追加確認事項
- UI フッターと設定画面で表示されるバージョンがデータベース値と一致すること。
- 起動ログの冒頭に `[DPL] version=<value>` が出力されること。
