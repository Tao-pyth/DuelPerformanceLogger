<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Duel Performance Logger</title>
    <link rel="stylesheet" href="static/css/main.css" />
    <script type="text/javascript" src="/eel.js"></script>
    <script type="module" src="static/js/app.js" defer></script>
  </head>
  <body>
    <header class="app-header">
      <div class="app-header__titles">
        <h1>Duel Performance Logger</h1>
        <p class="app-header__subtitle"></p>
      </div>
      <div class="app-header__status">
        <span id="app-version">DPL.?.?.?</span>
        <div class="app-header__controls">
          <button id="refresh-button" type="button">最新の状態を取得</button>
          <button type="button" class="nav-button nav-button--compact" data-nav="back">
            ひとつ前の画面に戻る
          </button>
          <button type="button" class="nav-button nav-button--compact" data-nav="home">
            トップページへ戻る
          </button>
        </div>
      </div>
    </header>

    <main class="app-main">
      <section class="view view--active" data-view="dashboard">
        <div class="view__content dashboard-grid">
          <section class="panel" aria-labelledby="migration-title">
            <h2 id="migration-title">移行結果</h2>
            <p id="migration-result" class="panel__body panel__body--muted">
              初期化処理の結果はまだ取得されていません。
            </p>
          </section>

          <section class="panel" aria-labelledby="summary-title">
            <h2 id="summary-title">データサマリー</h2>
            <dl class="summary-grid">
              <div>
                <dt>デッキ数</dt>
                <dd id="deck-count">0</dd>
              </div>
              <div>
                <dt>シーズン数</dt>
                <dd id="season-count">0</dd>
              </div>
              <div>
                <dt>対戦ログ数</dt>
                <dd id="match-count">0</dd>
              </div>
            </dl>
          </section>

          <section class="panel" aria-labelledby="navigation-title">
            <h2 id="navigation-title">メニュー</h2>
            <div class="action-grid">
              <button type="button" class="nav-button" data-nav-target="deck-registration">
                デッキ情報を登録
              </button>
              <button type="button" class="nav-button" data-nav-target="season-registration">
                シーズン情報を登録
              </button>
              <button
                type="button"
                class="nav-button"
                data-nav-target="opponent-deck-registration"
              >
                対戦相手デッキを登録
              </button>
              <button type="button" class="nav-button" data-nav-target="match-start">
                対戦情報の登録を開始
              </button>
              <button type="button" class="nav-button" data-nav-target="keyword-management">
                対戦キーワードを管理
              </button>
              <button type="button" class="nav-button" data-nav-target="match-list">
                対戦情報を一覧で確認
              </button>
              <button type="button" class="nav-button" data-nav-target="match-stats">
                対戦統計を見る
              </button>
              <button type="button" class="nav-button" data-nav-target="settings">
                設定
              </button>
            </div>
          </section>

          <section class="panel" aria-labelledby="recent-matches-title">
            <h2 id="recent-matches-title">最新の対戦ログ</h2>
            <table class="data-table" id="matches-table">
              <thead>
                <tr>
                  <th scope="col">#</th>
                  <th scope="col">デッキ</th>
                  <th scope="col">相手デッキ</th>
                  <th scope="col">ターン</th>
                  <th scope="col">結果</th>
                  <th scope="col">記録時刻</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td colspan="6" class="data-table__empty">まだデータがありません。</td>
                </tr>
              </tbody>
            </table>
          </section>
        </div>
      </section>

      <section class="view" data-view="deck-registration" hidden>
        <div class="view__content stack">
          <section class="panel" aria-labelledby="deck-registration-title">
            <h2 id="deck-registration-title">デッキ情報登録</h2>
            <form id="deck-form" class="form-grid">
              <label class="form-field">
                <span>デッキ名</span>
                <input type="text" id="deck-name" name="name" required maxlength="120" />
              </label>
              <label class="form-field">
                <span>説明</span>
                <textarea
                  id="deck-description"
                  name="description"
                  rows="3"
                  maxlength="400"
                ></textarea>
              </label>
              <div class="form-actions">
                <button type="submit" class="primary-button">登録する</button>
              </div>
            </form>
          </section>

          <section class="panel" aria-labelledby="deck-list-title">
            <h3 id="deck-list-title">登録済みデッキ</h3>
            <table class="data-table" id="deck-table">
              <thead>
                <tr>
                  <th scope="col">デッキ名</th>
                  <th scope="col">説明</th>
                  <th scope="col">使用回数</th>
                  <th scope="col">操作</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td colspan="4" class="data-table__empty">まだデータがありません。</td>
                </tr>
              </tbody>
            </table>
          </section>
        </div>
      </section>

      <section class="view" data-view="season-registration" hidden>
        <div class="view__content stack">
          <section class="panel" aria-labelledby="season-registration-title">
            <h2 id="season-registration-title">シーズン情報登録</h2>
            <form id="season-form" class="form-grid season-form">
              <label class="form-field">
                <span>シーズン名</span>
                <input type="text" id="season-name" name="name" required maxlength="120" />
              </label>
              <div class="season-form__dates">
                <label class="form-field">
                  <span>開始日</span>
                  <input type="date" id="season-start-date" name="start_date" />
                </label>
                <label class="form-field">
                  <span>開始時刻</span>
                  <input type="time" id="season-start-time" name="start_time" />
                </label>
                <label class="form-field">
                  <span>終了日</span>
                  <input type="date" id="season-end-date" name="end_date" />
                </label>
                <label class="form-field">
                  <span>終了時刻</span>
                  <input type="time" id="season-end-time" name="end_time" />
                </label>
              </div>
              <label class="form-field">
                <span>備考</span>
                <textarea id="season-notes" name="notes" rows="3" maxlength="400"></textarea>
              </label>
              <label class="form-field form-field--inline">
                <span>ランク統計対象</span>
                <input
                  type="checkbox"
                  id="season-rank-target"
                  name="rank_statistics_target"
                  value="1"
                />
              </label>
              <p class="form-field__help">
                チェックしたシーズンの対戦のみ直近対戦記録に表示されます。
              </p>
              <div class="form-actions">
                <button type="submit" class="primary-button">登録する</button>
              </div>
            </form>
          </section>

          <section class="panel" aria-labelledby="season-list-title">
            <h3 id="season-list-title">登録済みシーズン</h3>
            <table class="data-table" id="season-table">
              <thead>
                <tr>
                  <th scope="col">シーズン名</th>
                  <th scope="col">期間</th>
                  <th scope="col">ランク統計対象</th>
                  <th scope="col">備考</th>
                  <th scope="col">操作</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td colspan="5" class="data-table__empty">まだデータがありません。</td>
                </tr>
              </tbody>
            </table>
          </section>
        </div>
      </section>

      <section class="view" data-view="opponent-deck-registration" hidden>
        <div class="view__content stack">
          <section class="panel" aria-labelledby="opponent-registration-title">
            <h2 id="opponent-registration-title">対戦相手デッキ登録</h2>
            <form id="opponent-deck-form" class="form-grid">
              <label class="form-field">
                <span>デッキ名</span>
                <input
                  type="text"
                  id="opponent-deck-name"
                  name="name"
                  required
                  maxlength="120"
                />
              </label>
              <div class="form-actions">
                <button type="submit" class="primary-button">登録する</button>
              </div>
            </form>
          </section>

          <section class="panel" aria-labelledby="opponent-deck-list-title">
            <h3 id="opponent-deck-list-title">登録済み対戦相手デッキ</h3>
            <table class="data-table" id="opponent-deck-table">
              <thead>
                <tr>
                  <th scope="col">デッキ名</th>
                  <th scope="col">使用回数</th>
                  <th scope="col">操作</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td colspan="3" class="data-table__empty">まだデータがありません。</td>
                </tr>
              </tbody>
            </table>
          </section>
        </div>
      </section>

      <section class="view" data-view="keyword-management" hidden>
        <div class="view__content stack">
          <section class="panel" aria-labelledby="keyword-registration-title">
            <h2 id="keyword-registration-title">対戦キーワード登録</h2>
            <form id="keyword-form" class="form-grid">
              <label class="form-field">
                <span>キーワード名</span>
                <input type="text" id="keyword-name" name="name" required maxlength="120" />
              </label>
              <label class="form-field">
                <span>説明</span>
                <textarea
                  id="keyword-description"
                  name="description"
                  rows="3"
                  maxlength="400"
                ></textarea>
              </label>
              <div class="form-actions">
                <button type="submit" class="primary-button">登録する</button>
              </div>
            </form>
          </section>

          <section class="panel" aria-labelledby="keyword-list-title">
            <h3 id="keyword-list-title">登録済みキーワード</h3>
            <table class="data-table" id="keyword-table">
              <thead>
                <tr>
                  <th scope="col">キーワード名</th>
                  <th scope="col">内部ID</th>
                  <th scope="col">説明</th>
                  <th scope="col">使用回数</th>
                  <th scope="col">状態</th>
                  <th scope="col">操作</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td colspan="6" class="data-table__empty">まだデータがありません。</td>
                </tr>
              </tbody>
            </table>
          </section>
        </div>
      </section>

      <section class="view" data-view="match-start" hidden>
        <div class="view__content stack">
          <section class="panel" aria-labelledby="match-start-title">
            <h2 id="match-start-title">対戦情報登録開始</h2>
            <p class="panel__body panel__body--muted">
              登録したデッキから今回使用するデッキを選択してください。
            </p>
            <form id="match-start-form" class="form-grid">
              <label class="form-field">
                <span>使用するデッキ</span>
                <select id="match-start-deck" name="deck_name" required>
                  <option value="" selected>デッキを選択...</option>
                </select>
              </label>
              <label class="form-field">
                <span>シーズン</span>
                <select id="match-start-season" name="season_id">
                  <option value="" selected>シーズンを選択...</option>
                </select>
              </label>
              <div class="form-actions">
                <button type="submit" class="primary-button">対戦情報登録へ</button>
              </div>
            </form>
          </section>

          <section class="panel" aria-labelledby="match-start-hint-title">
            <h3 id="match-start-hint-title">ヒント</h3>
            <p class="panel__body panel__body--muted">
              対戦相手デッキが登録されていない場合は、先に「対戦相手デッキ登録」画面で追加してください。
            </p>
          </section>
        </div>
      </section>

      <section class="view" data-view="match-entry" hidden>
        <div class="view__content stack match-entry-layout">
          <section class="panel match-entry-panel" aria-labelledby="match-entry-title">
            <div class="match-entry-header" id="match-entry-title">
              <div class="match-entry-meta-grid">
                <span class="match-entry-meta__item">
                  使用デッキ：<span id="match-entry-deck-name">-</span>
                </span>
                <span class="match-entry-meta__item">
                  対戦番号：<span id="match-entry-number">-</span>
                </span>
                <span class="match-entry-meta__item">
                  シーズン：<span id="match-entry-season">-</span>
                </span>
              </div>
            </div>
            <form id="match-entry-form" class="match-entry-form">
              <div class="match-entry-row">
                <div class="match-entry-clock" aria-live="polite">
                  <span class="match-entry-clock__label">現在時刻</span>
                  <time id="match-entry-clock" class="match-entry-clock__time" datetime=""
                    >--:--:--</time
                  >
                  <span id="match-entry-date" class="match-entry-clock__date">(----/--/--)</span>
                </div>

                <fieldset class="match-entry-fieldset match-entry-fieldset--compact">
                  <legend>先攻 / 後攻 ・ 勝敗</legend>
                  <div class="match-entry-options-group">
                    <span class="match-entry-sublegend">先攻 / 後攻</span>
                    <div class="match-entry-options">
                      <label class="match-entry-option">
                        <input type="radio" name="turn" value="first" required />
                        <span class="match-entry-option__label">先攻</span>
                      </label>
                      <label class="match-entry-option">
                        <input type="radio" name="turn" value="second" required />
                        <span class="match-entry-option__label">後攻</span>
                      </label>
                    </div>
                  </div>
                  <div class="match-entry-options-group">
                    <span class="match-entry-sublegend">勝敗</span>
                    <div class="match-entry-options">
                      <label class="match-entry-option">
                        <input type="radio" name="result" value="1" required />
                        <span class="match-entry-option__label">Win</span>
                      </label>
                      <label class="match-entry-option">
                        <input type="radio" name="result" value="-1" required />
                        <span class="match-entry-option__label">Lose</span>
                      </label>
                      <label class="match-entry-option">
                        <input type="radio" name="result" value="0" required />
                        <span class="match-entry-option__label">Draw</span>
                      </label>
                    </div>
                  </div>
                </fieldset>

                <fieldset class="match-entry-fieldset match-entry-fieldset--compact">
                  <legend>登録モード</legend>
                  <div class="match-entry-options-group">
                    <span class="match-entry-sublegend">登録方法</span>
                    <div class="match-entry-options">
                      <label class="match-entry-option">
                        <input
                          type="radio"
                          name="entry_mode"
                          value="result_only"
                          checked
                        />
                        <span class="match-entry-option__label">結果のみ登録</span>
                      </label>
                      <label class="match-entry-option">
                        <input type="radio" name="entry_mode" value="record_and_register" />
                        <span class="match-entry-option__label">録画と登録</span>
                      </label>
                    </div>
                  </div>
                  <p class="match-entry-hint">
                    録画モードを選択すると、先攻/後攻を確定したタイミングで録画を開始します。
                  </p>
                </fieldset>

                <label class="match-entry-select">
                  <span class="match-entry-select__label">対戦相手デッキ</span>
                  <input
                    type="text"
                    id="match-opponent"
                    name="opponent_deck"
                    list="match-opponent-list"
                    placeholder="対戦相手デッキを選択または入力..."
                    required
                    autocomplete="off"
                  />
                  <datalist id="match-opponent-list"></datalist>
                </label>

                <div class="match-entry-select match-entry-select--keywords">
                  <span class="match-entry-select__label">対戦キーワード</span>
                  <div
                    id="match-keywords"
                    class="keyword-toggle-list"
                    role="group"
                    aria-label="対戦キーワード"
                  ></div>
                  <input type="hidden" id="match-keywords-input" name="keywords" />
                  <small class="match-entry-hint">ボタンを選択してキーワードを指定できます</small>
                </div>
              </div>

              <label class="match-entry-memo">
                <span class="match-entry-memo__label">対戦メモ</span>
                <textarea
                  id="match-entry-memo"
                  name="memo"
                  rows="3"
                  placeholder="対戦内容や感想を入力..."
                ></textarea>
              </label>

              <div class="match-entry-actions">
                <button type="submit" class="primary-button">対戦情報を登録</button>
              </div>

              <div
                id="match-entry-automation-result"
                class="match-entry-automation"
                hidden
              >
                <div class="match-entry-automation__content">
                  <span
                    id="match-entry-automation-message"
                    class="match-entry-automation__message"
                  ></span>
                  <a
                    id="match-entry-automation-link"
                    class="match-entry-automation__link"
                    href="#"
                    target="_blank"
                    rel="noopener"
                    hidden
                  ></a>
                  <code
                    id="match-entry-automation-path"
                    class="match-entry-automation__value"
                    hidden
                  ></code>
                </div>
                <button
                  type="button"
                  class="secondary-button"
                  id="match-entry-automation-copy"
                  hidden
                >
                  コピー
                </button>
              </div>
            </form>
          </section>
        </div>
      </section>

      <section class="view" data-view="match-list" hidden>
        <div class="view__content stack">
          <section class="panel" aria-labelledby="match-list-title">
            <h2 id="match-list-title">対戦情報一覧</h2>
            <table class="data-table" id="match-list-table">
              <thead>
                <tr>
                  <th scope="col">記録時刻</th>
                  <th scope="col">使用デッキ</th>
                  <th scope="col">#</th>
                  <th scope="col">勝敗</th>
                  <th scope="col">詳細</th>
                  <th scope="col">削除</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td colspan="6" class="data-table__empty">まだデータがありません。</td>
                </tr>
              </tbody>
            </table>
          </section>
        </div>
      </section>

      <section class="view" data-view="match-detail" hidden>
        <div class="view__content stack">
          <section class="panel match-detail-panel" aria-labelledby="match-detail-title">
            <div class="panel__header match-detail-header">
              <h2 id="match-detail-title">対戦情報詳細</h2>
              <button type="button" class="primary-button" id="match-detail-edit">
                編集する
              </button>
            </div>
            <dl class="match-detail-grid">
              <div>
                <dt>記録時刻</dt>
                <dd id="match-detail-timestamp">-</dd>
              </div>
              <div>
                <dt>使用デッキ</dt>
                <dd id="match-detail-deck">-</dd>
              </div>
              <div>
                <dt>シーズン</dt>
                <dd id="match-detail-season">-</dd>
              </div>
              <div>
                <dt>対戦番号</dt>
                <dd id="match-detail-number">-</dd>
              </div>
              <div>
                <dt>勝敗</dt>
                <dd id="match-detail-result">-</dd>
              </div>
              <div>
                <dt>先攻 / 後攻</dt>
                <dd id="match-detail-turn">-</dd>
              </div>
              <div>
                <dt>対戦相手デッキ</dt>
                <dd id="match-detail-opponent">-</dd>
              </div>
              <div>
                <dt>キーワード</dt>
                <dd id="match-detail-keywords" class="match-detail-keywords">-</dd>
              </div>
              <div>
                <dt>対戦メモ</dt>
                <dd id="match-detail-memo">-</dd>
              </div>
              <div>
                <dt>YouTube</dt>
                <dd>
                  <div class="match-detail-youtube">
                    <div class="match-detail-youtube__status">
                      <span
                        id="match-detail-youtube-status"
                        class="status-pill status-pill--idle"
                        >未送信</span
                      >
                      <small id="match-detail-youtube-checked-at" class="match-detail-youtube__checked">―</small>
                    </div>
                    <div id="match-detail-youtube-link" class="match-detail-youtube__link">―</div>
                    <div class="match-detail-youtube__controls">
                      <label class="match-detail-youtube__field">
                        <span class="sr-only">YouTube URL を入力</span>
                        <input type="url" id="match-detail-youtube-input" placeholder="https://www.youtube.com/..." />
                      </label>
                      <div class="match-detail-youtube__actions">
                        <button type="button" id="match-detail-youtube-save" class="secondary-button">
                          URLを保存
                        </button>
                        <button type="button" id="match-detail-youtube-retry" class="secondary-button">
                          再試行
                        </button>
                      </div>
                      <input
                        type="text"
                        id="match-detail-recording-path"
                        class="match-detail-youtube__recording"
                        placeholder="録画ファイル名 (省略可)"
                      />
                    </div>
                  </div>
                </dd>
              </div>
              <div>
                <dt>お気に入り</dt>
                <dd id="match-detail-favorite">-</dd>
              </div>
            </dl>
          </section>
        </div>
      </section>

      <section class="view" data-view="match-edit" hidden>
        <div class="view__content stack">
          <section class="panel" aria-labelledby="match-edit-title">
            <div class="panel__header match-detail-header">
              <h2 id="match-edit-title">対戦情報を編集</h2>
            </div>
            <form id="match-edit-form" class="form-grid match-edit-form">
              <label class="form-field">
                <span>使用デッキ</span>
                <select id="match-edit-deck" name="deck_name" required></select>
              </label>
              <label class="form-field">
                <span>シーズン</span>
                <select id="match-edit-season" name="season_id">
                  <option value="">シーズンを選択...</option>
                </select>
              </label>
              <label class="form-field">
                <span>対戦番号</span>
                <input type="number" id="match-edit-number" name="match_no" min="1" required />
              </label>
              <fieldset class="match-entry-fieldset">
                <legend>先攻 / 後攻</legend>
                <div class="match-entry-options">
                  <label class="match-entry-option">
                    <input type="radio" name="turn" value="first" required />
                    <span class="match-entry-option__label">先攻</span>
                  </label>
                  <label class="match-entry-option">
                    <input type="radio" name="turn" value="second" required />
                    <span class="match-entry-option__label">後攻</span>
                  </label>
                </div>
              </fieldset>
              <label class="form-field">
                <span>対戦相手デッキ</span>
                <select id="match-edit-opponent" name="opponent_deck" required></select>
              </label>
              <div class="form-field match-edit-keywords">
                <span>対戦キーワード</span>
                <div
                  id="match-edit-keywords"
                  class="keyword-toggle-list keyword-toggle-list--edit"
                  role="group"
                  aria-label="編集する対戦キーワード"
                ></div>
                <input type="hidden" id="match-edit-keywords-input" name="keywords" />
                <small class="form-field__help">ボタンをクリックして選択を切り替えます</small>
              </div>
              <fieldset class="match-entry-fieldset">
                <legend>勝敗</legend>
                <div class="match-entry-options">
                  <label class="match-entry-option">
                    <input type="radio" name="result" value="1" required />
                    <span class="match-entry-option__label">Win</span>
                  </label>
                  <label class="match-entry-option">
                    <input type="radio" name="result" value="-1" required />
                    <span class="match-entry-option__label">Lose</span>
                  </label>
                  <label class="match-entry-option">
                    <input type="radio" name="result" value="0" required />
                    <span class="match-entry-option__label">Draw</span>
                  </label>
                </div>
              </fieldset>
              <label class="form-field">
                <span>対戦メモ</span>
                <textarea
                  id="match-edit-memo"
                  name="memo"
                  rows="4"
                  placeholder="対戦内容や感想を入力..."
                ></textarea>
              </label>
              <label class="form-field">
                <span>対戦ログ YouTube URL</span>
                <input type="url" id="match-edit-youtube" name="youtube_url" placeholder="https://www.youtube.com/..." />
              </label>
              <label class="form-field form-field--inline">
                <span>お気に入り</span>
                <input type="checkbox" id="match-edit-favorite" name="favorite" />
              </label>
              <div class="form-actions">
                <button type="submit" class="primary-button">保存する</button>
                <button type="button" class="secondary-button" data-nav="back">キャンセル</button>
              </div>
            </form>
          </section>
        </div>
      </section>

      <section class="view" data-view="match-stats" hidden>
        <div class="view__content stack">
          <section class="panel" aria-labelledby="match-stats-title">
            <h2 id="match-stats-title">統計メニュー</h2>
            <p class="panel__body panel__body--muted">
              デッキや対戦相手ごとのパフォーマンスを分析できるビューを選択してください。
            </p>
            <div class="analysis-link-grid">
              <button type="button" class="nav-button" data-nav-target="deck-analysis">
                デッキタイプ別分析
              </button>
              <button type="button" class="nav-button" data-nav-target="opponent-analysis">
                対戦相手デッキタイプ別分析
              </button>
            </div>
          </section>
        </div>
      </section>

      <section class="view" data-view="deck-analysis" hidden>
        <div class="view__content stack">
          <section class="panel analysis-panel" aria-labelledby="deck-analysis-title">
            <div class="analysis-header">
              <div>
                <h2 id="deck-analysis-title">デッキタイプ別分析</h2>
                <p class="panel__body panel__body--muted">
                  自分が使用した各デッキタイプの勝率や平均スコアを確認できます。
                </p>
              </div>
              <label class="analysis-filter">
                <span>対象シーズン</span>
                <select id="deck-analysis-filter"></select>
              </label>
            </div>
            <div class="analysis-summary" id="deck-analysis-summary"></div>
          </section>
          <section class="panel" aria-labelledby="deck-analysis-table-title">
            <div class="panel__header">
              <h3 id="deck-analysis-table-title">デッキ別指標</h3>
            </div>
            <table class="data-table analysis-table" id="deck-analysis-table">
              <thead>
                <tr>
                  <th scope="col">デッキタイプ</th>
                  <th scope="col">試合数</th>
                  <th scope="col">勝ち</th>
                  <th scope="col">負け</th>
                  <th scope="col">引き分け</th>
                  <th scope="col">勝率</th>
                  <th scope="col">平均スコア</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td colspan="7" class="data-table__empty">データがありません。</td>
                </tr>
              </tbody>
            </table>
          </section>
          <section class="panel" aria-labelledby="deck-analysis-chart-title">
            <div class="panel__header">
              <h3 id="deck-analysis-chart-title">使用回数と勝率</h3>
            </div>
            <div class="analysis-chart-wrapper">
              <canvas id="deck-analysis-chart" width="960" height="320" role="img"></canvas>
            </div>
          </section>
        </div>
      </section>

      <section class="view" data-view="opponent-analysis" hidden>
        <div class="view__content stack">
          <section class="panel analysis-panel" aria-labelledby="opponent-analysis-title">
            <div class="analysis-header">
              <div>
                <h2 id="opponent-analysis-title">対戦相手デッキタイプ別分析</h2>
                <p class="panel__body panel__body--muted">
                  対戦相手のデッキごとの勝率を把握し、対策が必要な相手を確認できます。
                </p>
              </div>
              <label class="analysis-filter">
                <span>対象シーズン</span>
                <select id="opponent-analysis-filter"></select>
              </label>
            </div>
            <div class="analysis-summary" id="opponent-analysis-summary"></div>
          </section>
          <section class="panel" aria-labelledby="opponent-analysis-table-title">
            <div class="panel__header">
              <h3 id="opponent-analysis-table-title">対戦相手別指標</h3>
            </div>
            <table class="data-table analysis-table" id="opponent-analysis-table">
              <thead>
                <tr>
                  <th scope="col">対戦相手デッキ</th>
                  <th scope="col">試合数</th>
                  <th scope="col">勝ち</th>
                  <th scope="col">負け</th>
                  <th scope="col">引き分け</th>
                  <th scope="col">勝率</th>
                  <th scope="col">平均スコア</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td colspan="7" class="data-table__empty">データがありません。</td>
                </tr>
              </tbody>
            </table>
          </section>
          <section class="panel" aria-labelledby="opponent-analysis-chart-title">
            <div class="panel__header">
              <h3 id="opponent-analysis-chart-title">対戦勝率チャート</h3>
            </div>
            <div class="analysis-chart-wrapper">
              <canvas id="opponent-analysis-chart" width="960" height="320" role="img"></canvas>
            </div>
          </section>
        </div>
      </section>

      <section class="view" data-view="settings" hidden>
        <div class="view__content stack">
          <section class="panel" aria-labelledby="settings-title">
            <h2 id="settings-title">設定</h2>
            <p class="panel__body panel__body--muted">
              アプリケーションの状態やバックアップ履歴を確認し、必要に応じてデータのエクスポート・インポートを行えます。
            </p>
            <dl class="info-list">
              <div>
                <dt>前回の移行メッセージ</dt>
                <dd id="settings-migration">-</dd>
                <p class="settings-subtext" id="settings-migration-timestamp">最終実行：-</p>
              </div>
              <div>
                <dt>データベースの保存先</dt>
                <dd id="settings-db-path">-</dd>
              </div>
              <div>
                <dt>最新バックアップ</dt>
                <dd>
                  <div id="settings-last-backup-path">-</div>
                  <p class="settings-subtext" id="settings-last-backup-at">-</p>
                </dd>
              </div>
            </dl>
          </section>

          <section class="panel" aria-labelledby="recording-settings-title">
            <div class="panel__header">
              <h3 id="recording-settings-title">録画設定</h3>
              <p class="settings-subtext" id="recording-status-label">状態：未取得</p>
            </div>
            <form id="recording-settings-form" class="form-grid recording-settings-form">
              <label class="form-field form-field--inline recording-settings-form__toggle">
                <span>FFmpeg を使用する</span>
                <input type="checkbox" id="recording-use-ffmpeg" name="ffmpeg_enabled" />
              </label>
              <fieldset class="recording-settings-form__fieldset" data-ffmpeg-scope>
                <label class="form-field">
                  <span>保存先ディレクトリ</span>
                  <input type="text" id="recording-save-directory" name="save_directory" required />
                </label>
                <div class="form-field">
                  <span>画質テンプレート</span>
                  <div class="recording-quality-options" role="radiogroup">
                    <label class="recording-quality-option">
                      <input
                        type="radio"
                        name="recording-quality"
                        value="standard"
                        data-quality-value="standard"
                      />
                      <span class="recording-quality-option__title">標準</span>
                      <span class="recording-quality-option__description">60 FPS / 6000 kbps</span>
                    </label>
                    <label class="recording-quality-option">
                      <input
                        type="radio"
                        name="recording-quality"
                        value="high"
                        data-quality-value="high"
                      />
                      <span class="recording-quality-option__title">高画質</span>
                      <span class="recording-quality-option__description">60 FPS / 12000 kbps</span>
                    </label>
                    <label class="recording-quality-option">
                      <input
                        type="radio"
                        name="recording-quality"
                        value="light"
                        data-quality-value="light"
                      />
                      <span class="recording-quality-option__title">軽量</span>
                      <span class="recording-quality-option__description">30 FPS / 4000 kbps</span>
                    </label>
                  </div>
                </div>
                <div class="recording-quality-summary" aria-live="polite">
                  <p class="recording-quality-summary__title">選択中のテンプレート</p>
                  <dl class="recording-quality-summary__details">
                    <div>
                      <dt>テンプレート</dt>
                      <dd id="recording-quality-label">―</dd>
                    </div>
                    <div>
                      <dt>FPS</dt>
                      <dd id="recording-summary-fps">―</dd>
                    </div>
                    <div>
                      <dt>ビデオビットレート</dt>
                      <dd id="recording-summary-bitrate">―</dd>
                    </div>
                    <div>
                      <dt>オーディオビットレート</dt>
                      <dd id="recording-summary-audio-bitrate">―</dd>
                    </div>
                  </dl>
                </div>
                <input type="hidden" id="recording-bitrate" data-quality-field="bitrate" />
                <input type="hidden" id="recording-audio-bitrate" data-quality-field="audio_bitrate" />
                <input type="hidden" id="recording-fps" data-quality-field="fps" />
                <label class="form-field">
                  <span>プロファイル</span>
                  <select id="recording-profile" name="profile">
                    <option value="16:9">16:9</option>
                    <option value="21:9">21:9</option>
                    <option value="32:9">32:9</option>
                  </select>
                </label>
                <label class="form-field">
                  <span>FFmpeg パス（任意）</span>
                  <input type="text" id="recording-ffmpeg-path" name="ffmpeg_path" />
                </label>
                <label class="form-field form-field--inline">
                  <span>FFmpeg 自動ダウンロード</span>
                  <input type="checkbox" id="recording-auto-download" name="auto_download_ffmpeg" />
                </label>
                <label class="form-field">
                  <span>オーディオデバイス（任意）</span>
                  <input type="text" id="recording-audio-device" name="audio_device" />
                </label>
                <label class="form-field">
                  <span>映像ソース</span>
                  <input type="text" id="recording-video-source" name="video_source" />
                </label>
              </fieldset>
              <div class="form-actions">
                <button type="submit" class="secondary-button" id="recording-settings-save">設定を保存</button>
              </div>
            </form>
            <div class="recording-controls" data-ffmpeg-controls>
              <label class="form-field form-field--inline recording-match-id">
                <span>対象対戦ID（任意）</span>
                <input type="number" id="recording-match-id" min="1" step="1" />
              </label>
              <div class="recording-controls__buttons">
                <button type="button" class="primary-button" id="recording-start">録画開始</button>
                <button type="button" class="secondary-button" id="recording-stop">録画停止</button>
                <button type="button" class="secondary-button" id="recording-screenshot">スクリーンショット</button>
              </div>
            </div>
            <dl class="info-list recording-info">
              <div>
                <dt>最後の録画ファイル</dt>
                <dd id="recording-last-output">―</dd>
              </div>
              <div>
                <dt>最後のスクリーンショット</dt>
                <dd id="recording-last-screenshot">―</dd>
              </div>
            </dl>
          </section>

          <section class="panel" aria-labelledby="settings-backup-title">
            <div class="panel__header">
              <h3 id="settings-backup-title">バックアップ / リストア</h3>
            </div>
            <div class="settings-backup-actions">
              <button type="button" class="primary-button" id="settings-backup-export">
                CSV-Zip をダウンロード
              </button>
              <label class="settings-import-button">
                <input type="file" id="settings-backup-import" accept=".zip" hidden />
                <span class="secondary-button">CSV-Zip を取り込む</span>
              </label>
            </div>
            <p class="settings-subtext" id="settings-import-status">インポート待機中</p>
          </section>

          <section class="panel" aria-labelledby="settings-reset-title">
            <div class="panel__header">
              <h3 id="settings-reset-title">データベース初期化</h3>
            </div>
            <p class="panel__body panel__body--muted">
              初期化を実行するとすべての対戦情報が削除されます。事前にバックアップを取得してから実行することを推奨します。
            </p>
            <div class="form-actions">
              <button type="button" class="secondary-button" id="settings-reset-db">
                データベースを初期化
              </button>
            </div>
          </section>
        </div>
      </section>
    </main>

    <div id="toast" role="status" aria-live="polite" hidden></div>
  </body>
</html>
